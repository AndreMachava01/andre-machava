{% extends 'base_admin.html' %}
{% load static %}

{% block title %}{% if form.instance.pk %}Editar{% else %}Nova{% endif %} Prova de Entrega (POD){% endblock %}

{% block content %}
<div class="container">
    <!-- Breadcrumb -->
    <nav class="breadcrumb-modern">
        <a href="/dashboard/">
            <i class="fas fa-home"></i>
            Dashboard
        </a>
        <i class="fas fa-chevron-right"></i>
        <a href="/stock/">
            <i class="fas fa-warehouse"></i>
            Stock
        </a>
        <i class="fas fa-chevron-right"></i>
        <a href="/stock/logistica/">
            <i class="fas fa-truck"></i>
            Logística
        </a>
        <i class="fas fa-chevron-right"></i>
        <a href="{% url 'stock:pod:dashboard' %}">POD & Documentos</a>
        <i class="fas fa-chevron-right"></i>
        <a href="{% url 'stock:pod:provas_list' %}">Provas de Entrega</a>
        <i class="fas fa-chevron-right"></i>
        <span>{% if form.instance.pk %}Editar{% else %}Nova{% endif %} POD</span>
    </nav>

    <!-- Page Header -->
    <div class="page-header">
        <div class="page-header-content">
            <div>
                <h1 class="page-title">
                    <i class="fas fa-plus-circle"></i>
                    {% if form.instance.pk %}Editar Prova de Entrega (POD){% else %}Nova Prova de Entrega (POD){% endif %}
                </h1>
                <p class="page-subtitle">
                    {% if form.instance.pk %}Atualize os detalhes da prova de entrega existente.{% else %}Crie uma nova prova de entrega para registrar uma entrega.{% endif %}
                </p>
            </div>
            <div class="header-actions">
                <a href="{% url 'stock:pod:provas_list' %}" class="btn btn-secondary">
                    <i class="fas fa-arrow-left"></i>
                    Voltar às Provas
                </a>
            </div>
        </div>
    </div>

    <!-- Messages -->
    {% if messages %}
        {% for message in messages %}
            <div class="alert alert-{{ message.tags }}">
                <i class="fas fa-{% if message.tags == 'error' %}exclamation-triangle{% elif message.tags == 'success' %}check-circle{% else %}info-circle{% endif %}"></i>
                {{ message }}
            </div>
        {% endfor %}
    {% endif %}

    <div class="card">
        <div class="card-header">
            <h3 class="card-title">
                <i class="fas fa-clipboard-list"></i>
                Dados da Prova de Entrega
            </h3>
        </div>
        <div class="card-body">
            <form method="post" enctype="multipart/form-data">
                {% csrf_token %}

                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group mb-3">
                            <label for="{{ form.rastreamento_entrega.id_for_label }}" class="form-label">
                                <i class="fas fa-route"></i> Rastreamento Associado
                            </label>
                            {{ form.rastreamento_entrega }}
                            {% if form.rastreamento_entrega.errors %}
                                <div class="text-danger small mt-1">{{ form.rastreamento_entrega.errors }}</div>
                            {% endif %}
                            <small class="form-text text-muted">
                                Selecione o rastreamento ao qual esta prova de entrega se refere.
                            </small>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group mb-3">
                            <label for="{{ form.codigo.id_for_label }}" class="form-label">
                                <i class="fas fa-barcode"></i> Código da POD
                            </label>
                            {{ form.codigo }}
                            {% if form.codigo.errors %}
                                <div class="text-danger small mt-1">{{ form.codigo.errors }}</div>
                            {% endif %}
                            <small class="form-text text-muted">
                                Código único para identificar esta prova de entrega.
                            </small>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group mb-3">
                            <label for="{{ form.data_entrega.id_for_label }}" class="form-label">
                                <i class="fas fa-calendar-alt"></i> Data e Hora da Entrega
                            </label>
                            {{ form.data_entrega }}
                            {% if form.data_entrega.errors %}
                                <div class="text-danger small mt-1">{{ form.data_entrega.errors }}</div>
                            {% endif %}
                            <small class="form-text text-muted">
                                Data e hora em que a entrega foi realizada.
                            </small>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group mb-3">
                            <label for="{{ form.status.id_for_label }}" class="form-label">
                                <i class="fas fa-info-circle"></i> Status da POD
                            </label>
                            {{ form.status }}
                            {% if form.status.errors %}
                                <div class="text-danger small mt-1">{{ form.status.errors }}</div>
                            {% endif %}
                            <small class="form-text text-muted">
                                Status atual da prova de entrega (ex: Concluída, Pendente).
                            </small>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group mb-3">
                            <label for="{{ form.tipo_entrega.id_for_label }}" class="form-label">
                                <i class="fas fa-truck-loading"></i> Tipo de Entrega
                            </label>
                            {{ form.tipo_entrega }}
                            {% if form.tipo_entrega.errors %}
                                <div class="text-danger small mt-1">{{ form.tipo_entrega.errors }}</div>
                            {% endif %}
                            <small class="form-text text-muted">
                                Indica se a entrega foi completa, parcial ou recusada.
                            </small>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group mb-3">
                            <label for="{{ form.nome_destinatario.id_for_label }}" class="form-label">
                                <i class="fas fa-user"></i> Nome do Destinatário
                            </label>
                            {{ form.nome_destinatario }}
                            {% if form.nome_destinatario.errors %}
                                <div class="text-danger small mt-1">{{ form.nome_destinatario.errors }}</div>
                            {% endif %}
                            <small class="form-text text-muted">
                                Nome completo da pessoa que recebeu a entrega.
                            </small>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group mb-3">
                            <label for="{{ form.documento_destinatario.id_for_label }}" class="form-label">
                                <i class="fas fa-id-card"></i> Documento do Destinatário
                            </label>
                            {{ form.documento_destinatario }}
                            {% if form.documento_destinatario.errors %}
                                <div class="text-danger small mt-1">{{ form.documento_destinatario.errors }}</div>
                            {% endif %}
                            <small class="form-text text-muted">
                                Número de documento do recebedor (ex: BI, NUIT).
                            </small>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group mb-3">
                            <label for="{{ form.latitude.id_for_label }}" class="form-label">
                                <i class="fas fa-map-marker-alt"></i> Latitude
                            </label>
                            {{ form.latitude }}
                            {% if form.latitude.errors %}
                                <div class="text-danger small mt-1">{{ form.latitude.errors }}</div>
                            {% endif %}
                            <small class="form-text text-muted">
                                Coordenada de latitude do local de entrega.
                            </small>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group mb-3">
                            <label for="{{ form.longitude.id_for_label }}" class="form-label">
                                <i class="fas fa-map-marker-alt"></i> Longitude
                            </label>
                            {{ form.longitude }}
                            {% if form.longitude.errors %}
                                <div class="text-danger small mt-1">{{ form.longitude.errors }}</div>
                            {% endif %}
                            <small class="form-text text-muted">
                                Coordenada de longitude do local de entrega.
                            </small>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group mb-3">
                            <label for="{{ form.validada.id_for_label }}" class="form-label">
                                <i class="fas fa-check-circle"></i> Validada
                            </label>
                            <div class="form-check form-switch">
                                {{ form.validada }}
                                <label class="form-check-label" for="{{ form.validada.id_for_label }}">
                                    Marque se a prova de entrega foi validada.
                                </label>
                            </div>
                            {% if form.validada.errors %}
                                <div class="text-danger small mt-1">{{ form.validada.errors }}</div>
                            {% endif %}
                        </div>
                    </div>
                    <div class="col-12">
                        <div class="form-group mb-3">
                            <label for="{{ form.observacoes.id_for_label }}" class="form-label">
                                <i class="fas fa-comment-alt"></i> Observações
                            </label>
                            {{ form.observacoes }}
                            {% if form.observacoes.errors %}
                                <div class="text-danger small mt-1">{{ form.observacoes.errors }}</div>
                            {% endif %}
                            <small class="form-text text-muted">
                                Quaisquer observações adicionais sobre a entrega.
                            </small>
                        </div>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save"></i> Salvar Prova de Entrega
                    </button>
                    <a href="{% url 'stock:pod:provas_list' %}" class="btn btn-secondary">
                        <i class="fas fa-times"></i> Cancelar
                    </a>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}