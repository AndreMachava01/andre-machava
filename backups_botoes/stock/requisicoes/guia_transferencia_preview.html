

{% extends "base_admin.html" %}
{% load static %}

{% block title %}Preview - Guia de Transferência - {{ transferencia.codigo }}{% endblock %}

{% block extra_style %}

{% endblock %}

{% block content %}
<!-- Botões de Ação Padronizados -->
<div class="action-btns -responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive" role="button" role="button" role="button" role="button" role="button">
    <a href="#"stock:requisicoes:detail' requisicao.id %}" class="document-btn document-btn btn btn btn btn btn btn-secondary btn-responsive -responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive">
        <i class="fas fa-arrow-left"></i> Voltar à Requisição
    </a>
    <button onclick=")" class="document-btn document-btn-primary" class="btn btn-primary btn-responsive" id="btn-{{ forloop.counter|default:"1" }}" aria-label="Botão de ação" title="Clique para executar ação" title="Clique para executar ação"" tabindex="0" class="btn btn btn-primary btn-responsive btn-responsive" id="btn-{{ forloop.counter|default:"1" }}" aria-label="Botão de ação" title="Clique para executar ação" title="Clique para executar ação"" tabindex="0" class="btn btn btn-primary btn-responsive btn-responsive" id="btn-{{ forloop.counter|default:"1" }}" aria-label="Botão de ação" title="Clique para executar ação" title="Clique para executar ação"" tabindex="0" class="btn btn btn-primary btn-responsive btn-responsive" id="btn-{{ forloop.counter|default:"1" }}" aria-label="Botão de ação" title="Clique para executar ação" title="Clique para executar ação"" tabindex="0" class="btn btn btn-primary btn-responsive btn-responsive" id="btn-{{ forloop.counter|default:"1" }}" aria-label="Botão de ação" title="Clique para executar ação" title="Clique para executar ação"" tabindex="0" class="btn btn btn-primary btn-responsive btn-responsive" id="btn-{{ forloop.counter|default:"1" }}" aria-label="Botão de ação" title="Clique para executar ação" title="Clique para executar ação"" tabindex="0">
        <i class="fas fa-print"></i> Imprimir Guia
    </button>
    <a href="#" class="document-btn document-btn-outline btn-responsive -responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive">
        <i class="fas fa-home"></i> Dashboard Stock
    </a>
</div>

<div class="modern-container">
    <!-- Breadcrumb -->
    <nav aria-label="breadcrumb" class="breadcrumb-nav">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="{% url "stock:main" %}">Stock</a></li>
            <li class="breadcrumb-item"><a href="{% url "stock:requisicoes:list" %}">Requisições</a></li>
            <li class="breadcrumb-item"><a href="{% url 'stock:requisicoes:detail' requisicao.id %}">{{ requisicao.codigo }}</a></li>
            <li class="breadcrumb-item active">Preview - Guia de Transferência</li>
        </ol>
    </nav>

    <!-- Header Profissional -->
    <div class="page-header-professional">
        <div class="header-content">
            <div class="header-info">
                <div class="document-type">
                    <i class="fas fa-file-export"></i>
                    <span>GUIA DE TRANSFERÊNCIA</span>
                </div>
                <h1>Preview do Documento</h1>
                <div class="document-codes">
                    <span class="code-item">
                        <strong>Transferência:</strong> {{ transferencia.codigo }}
                    </span>
                    <span class="code-item">
                        <strong>Requisição:</strong> {{ requisicao.codigo }}
                    </span>
                </div>
            </div>
        </div>
    </div>

    <!-- Content Section -->
    <div class="content-section">
        
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">
                    <i class="fas fa-info-circle me-2"></i>Informações da Transferência
                </h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <div class="info-row">
                            <span class="info-label">Código da Transferência:</span>
                            <span class="info-value">{{ transferencia.codigo }}</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">Código da Requisição:</span>
                            <span class="info-value">{{ requisicao.codigo }}</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">Status:</span>
                            <span class="badge bg-success">{{ transferencia.status }}</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">Data de Criação:</span>
                            <span class="info-value">{{ transferencia.data_criacao|date:"d/m/Y H:i" }}</span>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="info-row">
                            <span class="info-label">Sucursal Origem:</span>
                            <span class="info-value">{{ transferencia.sucursal_origem.nome }}</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">Sucursal Destino:</span>
                            <span class="info-value">{{ transferencia.sucursal_destino.nome }}</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">Total de Itens:</span>
                            <span class="info-value">{{ itens_transferencia.count }}</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">Observações:</span>
                            <span class="info-value">{{ transferencia.observacoes|default:"Nenhuma" }}</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Status de Transferência -->
        <div class="status-card">
            <div class="status-indicator">
                <div class="status-icon">
                    <i class="fas fa-toggle-on"></i>
                </div>
                <div class="status-info">
                    <h3>Status da Transferência</h3>
                    <span class="badge-status bg-success">{{ transferencia.status }}</span>
                </div>
            </div>
            <div class="status-details">
                <span>Criada em {{ transferencia.data_criacao|date:"d/m/Y às H:i" }}</span>
            </div>
        </div>

        <!-- Informações Gerais -->
        <div class="cards-container">
            <!-- Informações da Transferência -->
            <div class="info-card">
                <div class="card-icon">
                    <i class="fas fa-exchange-alt"></i>
                </div>
                <div class="card-content">
                    <h4>Detalhes da Transferência</h4>
                    <div class="info-grid">
                        <div class="info-item">
                            <span class="label">Código</span>
                            <span class="value">{{ transferencia.codigo }}</span>
                        </div>
                        <div class="info-item">
                            <span class="label">Requisição</span>
                            <span class="value">{{ requisicao.codigo }}</span>
                        </div>
                        <div class="info-item">
                            <span class="label">Data</span>
                            <span class="value">{{ transferencia.data_criacao|date:"d/m/Y H:i" }}</span>
                        </div>
                        <div class="info-item">
                            <span class="label">Total de Itens</span>
                            <span class="value badge-number">{{ itens_transferencia.count }}</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Sucursais -->
            <div class="info-card">
                <div class="card-icon">
                    <i class="fas fa-building"></i>
                </div>
                <div class="card-content">
                    <h4>Transferência Entre Sucursais</h4>
                    <div class="transfer-flow">
                        <div class="sucursal-item">
                            <div class="sucursal-label">Origem</div>
                            <div class="sucursal-name">{{ transferencia.sucursal_origem.nome }}</div>
                        </div>
                        <div class="transfer-arrow">
                            <i class="fas fa-arrow-right"></i>
                        </div>
                        <div class="sucursal-item">
                            <div class="sucursal-label">Destino</div>
                            <div class="sucursal-name">{{ transferencia.sucursal_destino.nome }}</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Itens da Transferência -->
        <div class="items-section">
            <div class="section-header">
                <h3>
                    <i class="fas fa-boxes"></i>
                    Itens da Transferência
                </h3>
                <span class="items-count">{{ itens_transferencia.count }} item(ns)</span>
            </div>
            
            <div class="items-table-container">
                <table class="modern-table">
                    <thead>
                        <tr>
                            <th class="item-column">Item</th>
                            <th class="code-column">Código</th>
                            <th class="quantity-column">Quantidade</th>
                            <th class="price-column">Preço Unitário</th>
                            <th class="total-column">Valor|default:0 total</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for items in itens_transferencia  %}
                        <tr class="item-row">
                            <td class="item-cell">
                                <div class="item-info">
                                    <div class="item-name">{{ item.item.nome }}</div>
                                    <div class="item-type">{{ item.item.get_tipo_display }}</div>
                                </div>
                            </td>
                            <td class="code-cell">
                                <span class="code-badge">{{ item.item.codigo }}</span>
                            </td>
                            <td class="quantity-cell">
                                <span class="quantity-badge">{{ item.quantidade_solicitada }}</span>
                            </td>
                            <td class="price-cell">
                                {{ item.item.preco_custo|floatformat:2 }} MT
                            </td>
                            <td class="total-cell">
                                <strong>{{ item.valor_item|floatformat:2 }} MT</strong>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            
            <div class="summary-section">
                <div class="total-summary">
                    <span class="total-label">TOTAL GERAL DA TRANSFERÊNCIA:</span>
                    <span class="total-value">{{ valor_total|floatformat:2 }} MT</span>
                </div>
            </div>
        </div>

        <!-- Ações Finais -->
        <div class="actions-section">
            <div class="actions-container">
                <div class="document-status">
                    <div class="status-icon-large">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <div class="status-text">
                        <h4>Documento Disponível</h4>
                        <p>Este guia de transferência está pronto para impressão</p>
                    </div>
                </div>
                
                <div class="actions-btns -responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive" role="button" role="button" role="button" role="button" role="button">
                    <a href="#"stock:requisicoes:guia_transferencia' requisicao.id %}" class="btn-main-action btn-print-document btn-responsive -responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive" target="_blank">
                        <div class="btn-icon-wrapper btn-responsive -responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive" role="button" role="button" role="button" role="button" role="button" role="button">
                            <i class="fas fa-print"></i>
                        </div>
                        <div class="btn-content btn-responsive -responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive" role="button" role="button" role="button" role="button" role="button" role="button">
                            <span class="btn-title btn-responsive -responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive" role="button" role="button" role="button" role="button" role="button" role="button">Gerar Documento Impressível</span>
                            <span class="btn-subtitle btn-responsive -responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive" role="button" role="button" role="button" role="button" role="button" role="button">Abrir em nova janela</span>
                        </div>
                        <div class="btn-arrow btn-responsive -responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive" role="button" role="button" role="button" role="button" role="button" role="button">
                            <i class="fas fa-external-link-alt"></i>
                        </div>
                    </a>
                    
                    <a href="#"stock:requisicoes:detail' requisicao.id %}" class="btn-main-action btn-back-to-requisition btn-responsive -responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive">
                        <div class="btn-icon-wrapper btn-responsive -responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive" role="button" role="button" role="button" role="button" role="button" role="button">
                            <i class="fas fa-arrow-left"></i>
                        </div>
                        <div class="btn-content btn-responsive -responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive" role="button" role="button" role="button" role="button" role="button" role="button">
                            <span class="btn-title btn-responsive -responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive" role="button" role="button" role="button" role="button" role="button" role="button">Voltar à Requisição</span>
                            <span class="btn-subtitle btn-responsive -responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive" role="button" role="button" role="button" role="button" role="button" role="button">{{ requisicao.codigo }}</span>
                        </div>
                        <div class="btn-arrow btn-responsive -responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive btn-responsive" role="button" role="button" role="button" role="button" role="button" role="button">
                            <i class="fas fa-chevron-right"></i>
                        </div>
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>


{% endblock %}
