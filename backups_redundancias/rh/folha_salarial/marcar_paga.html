{% extends 'base_admin.html' %}
{% load static %}

{% block title %}Marcar como Paga - {{ folha.mes_referencia|date:"F Y" }}{% endblock %}

{% block extra_style %}
<style>
    /* Estilos específicos do módulo - apenas gradiente no header */
    .page-header,
    .hero-section,
    .dashboard-header,
    .nav-top {
        background: var(--purple-gradient);
    }
</style>
{% endblock %}

{% block content %}
<div class="mark-paid-container">
    <div class="mark-paid-header">
        <h1><i class="fas fa-check-circle"></i> Marcar Folha como Paga</h1>
        <p>Folha de {{ folha.mes_referencia|date:"F Y" }} - Status: {{ folha.get_status_display }}</p>
    </div>
    
    <!-- Informação de Sucesso -->
    <div class="success-box">
        <h4>
            <i class="fas fa-info-circle"></i>
            Folha Pronta para Pagamento
        </h4>
        <p>
            Esta folha foi fechada e está pronta para ser marcada como paga. 
            Após marcar como paga, a folha não poderá mais ser reaberta.
        </p>
    </div>
    
    <!-- Informações da Folha -->
    <div class="folha-info">
        <h4><i class="fas fa-info-circle"></i> Informações da Folha</h4>
        <div class="info-grid">
            <div class="info-item">
                <div class="label">Mês</div>
                <div class="value">{{ folha.mes_referencia|date:"F Y" }}</div>
            </div>
            <div class="info-item">
                <div class="label">Status</div>
                <div class="value">{{ folha.get_status_display }}</div>
            </div>
            <div class="info-item">
                <div class="label">Data Fechamento</div>
                <div class="value">{{ folha.data_fechamento|date:"d/m/Y"|default:"N/A" }}</div>
            </div>
            <div class="info-item">
                <div class="label">Total Líquido</div>
                <div class="value">{{ folha.total_liquido|floatformat:2 }} MT</div>
            </div>
        </div>
    </div>
    
    <!-- Formulário -->
    <div class="mark-paid-form">
        <form method="post">
            {% csrf_token %}
            
            <div class="form-group">
                <label for="data_pagamento">
                    <i class="fas fa-calendar"></i>
                    Data de Pagamento
                </label>
                <div class="date-input-group">
                    <input 
                        type="date" 
                        id="data_pagamento" 
                        name="data_pagamento" 
                        value="{% now 'Y-m-d' %}"
                        required
                    >
                    <button type="button" class="btn-today" onclick="setToday()">
                        <i class="fas fa-calendar-day"></i>
                        Hoje
                    </button>
                </div>
                <div class="help-text">
                    Data em que a folha foi efetivamente paga aos funcionários.
                </div>
            </div>
            
            <div class="form-group">
                <label for="observacoes">
                    <i class="fas fa-comment"></i>
                    Observações (Opcional)
                </label>
                <textarea 
                    id="observacoes" 
                    name="observacoes" 
                    placeholder="Adicione observações sobre o pagamento..."
                ></textarea>
                <div class="help-text">
                    Informações adicionais sobre o pagamento (método, referência, etc.).
                </div>
            </div>
            
            <div class="action-buttons">
                <button type="submit" class="btn-marcar-paga">
                    <i class="fas fa-check-circle"></i>
                    Marcar como Paga
                </button>
                
                <a href="{% url 'rh:folha_detail' folha.id %}" class="btn-cancelar">
                    <i class="fas fa-times"></i>
                    Cancelar
                </a>
            </div>
        </form>
    </div>
</div>

<script>
function setToday() {
    const today = new Date();
    const dateString = today.toISOString().split('T')[0];
    document.getElementById('data_pagamento').value = dateString;
}
</script>
{% endblock %}
