{% extends 'base_admin.html' %}
{% load static %}

{% block title %}Deletar Promoção{% endblock %}

{% block extra_style %}
<style>
    /* Estilos específicos do módulo - apenas gradiente no header */
    .page-header,
    .hero-section,
    .dashboard-header,
    .nav-top {
        background: var(--purple-gradient);
    }
</style>
{% endblock %}

{% block content %}
<div class="nav-top">
    <h1>
        <i class="fas fa-trash-alt"></i>
        Deletar Promoção
    </h1>
    <div class="header-actions">
        <a href="#"rh:promocao_detail' promocao.id %}" class="btn btn btn-secondary btn-responsive btn-responsive">
            <i class="fas fa-arrow-left me-2"></i>Voltar
        </a>
    </div>
</div>

<div class="form-container">
    <!-- Aviso -->
    <div class="warning-icon">
        <i class="fas fa-exclamation-triangle"></i>
    </div>
    
    <!-- Informações da Promoção -->
    <div class="promocao-info">
        <h3>Informações da Promoção</h3>
        <div class="info-grid">
            <div class="info-item">
                <span class="info-label">Funcionário</span>
                <span class="info-value">{{ promocao.funcionario.nome_completo }}</span>
            </div>
            <div class="info-item">
                <span class="info-label">Tipo</span>
                <span class="info-value">{{ promocao.get_tipo_display }}</span>
            </div>
            <div class="info-item">
                <span class="info-label">Status</span>
                <span class="info-value">{{ promocao.get_status_display }}</span>
            </div>
            <div class="info-item">
                <span class="info-label">Salário Anterior</span>
                <span class="info-value">{{ promocao.salario_anterior|floatformat:2 }} MT</span>
            </div>
            <div class="info-item">
                <span class="info-label">Salário Novo</span>
                <span class="info-value">{{ promocao.salario_novo|floatformat:2 }} MT</span>
            </div>
            <div class="info-item">
                <span class="info-label">Data da Solicitação</span>
                <span class="info-value">{{ promocao.data_solicitacao|date:"d/m/Y" }}</span>
            </div>
        </div>
    </div>
    
    <!-- Avisos -->
    <div class="alert alert-danger">
        <strong>Atenção:</strong> Esta ação não pode ser desfeita. A promoção/aumento será permanentemente removida do sistema.
    </div>
    
    {% if promocao.status == 'IMPLEMENTADO' %}
    <div class="alert alert-warning">
        <strong>Importante:</strong> Esta promoção já foi implementada. Deletá-la não afetará o salário atual do funcionário, mas removerá o histórico da promoção.
    </div>
    {% endif %}
    
    <form method="POST"action="."method="post">{% csrf_token %}
        {% csrf_token %}
        
        <div class="form-actions">
            <a href="#"rh:promocao_detail' promocao.id %}" class="btn btn btn-secondary btn-responsive btn-responsive">
                <i class="fas fa-times me-2"></i>Cancelar
            </a>
            <button type="submit" class="btn btn btn-danger" class="btn btn btn-primary btn-responsive btn-responsive" id="btn-{{ forloop.counter|default:"1" }}" aria-label="Botão de ação" title="Clique para executar ação" title="Clique para executar ação">
                <i class="fas fa-trash-alt me-2"></i>Deletar Promoção
            </button>
        </div>
    </form>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const form = document.querySelector('form');
    
    form.addEventListener('submit', function(e) {
        if (!confirm('Tem certeza que deseja deletar esta promoção/aumento? Esta ação não pode ser desfeita.')) {
            e.preventDefault();
            return false;
        }
        
        // Confirmação adicional para promoções implementadas
        {% if promocao.status == 'IMPLEMENTADO' %}
        if (!confirm('Esta promoção já foi implementada. Deletá-la removerá o histórico, mas não afetará o salário atual do funcionário. Continuar?')) {
            e.preventDefault();
            return false;
        }
        {% endif %}
    });
});
</script>
{% endblock %}
